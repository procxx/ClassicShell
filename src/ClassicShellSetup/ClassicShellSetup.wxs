<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" -ext WixUIExtension -ext WixUtilExtension -dx64=0
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -ext WixUtilExtension -loc ClassicShellText-en-US.wxl
-->
<?if $(var.x64)=1 ?>
<?define CS_GUID = "$(env.CS_GUID64)"?>
<?define CS_UPGRADE = "779A74EF-23DE-4C71-AC12-2EE5A542ED34"?>
<?define CS_PLATFORM  = "x64"?>
<?define CS_PROGRAM_FILES  = "ProgramFiles64Folder"?>
<?define CS_WIN64  = "yes"?>
<?else ?>
<?define CS_GUID = "$(env.CS_GUID32)"?>
<?define CS_UPGRADE = "EB7DA1D9-44EA-43BF-8A08-0B103007D4F2"?>
<?define CS_PLATFORM  = "x86"?>
<?define CS_PROGRAM_FILES  = "ProgramFilesFolder"?>
<?define CS_WIN64  = "no"?>
<?endif ?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="$(var.CS_GUID)" Name="Classic Shell" Language="1033" Version="$(env.CS_VERSION)" Manufacturer="IvoSoft" UpgradeCode="$(var.CS_UPGRADE)">
        <Package Description="Classic Shell" Comments="Classic Shell" InstallerVersion="200" Compressed="yes" Platform="$(var.CS_PLATFORM)" />
        <Media Id="1" Cabinet="simple.cab" EmbedCab="yes" />
        <?if $(var.x64)=0 ?>
        <Condition Message="!(loc.Error32bit)">not Msix64</Condition>
        <?endif ?>
        <Condition Message="!(loc.ErrorVista)">VersionNT&gt;=600</Condition>
        <Condition Message="!(loc.ErrorNewVersion)">NOT NEWERPRODUCTFOUND OR Installed</Condition>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="$(var.CS_PROGRAM_FILES)" Name="PFiles">
                <Directory Id="APPLICATIONFOLDER" Name="Classic Shell">
                    <Directory Id="Skins" Name="Skins" />
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder" Name="Programs">
                <Directory Id="StartMenuDir" Name="Classic Shell">
                    <Component Id="StartMenuDir" Guid="42AA415A-5E61-4238-96B2-A997D1EE5521">
                        <RemoveFolder Id="StartMenuDir" On="uninstall" />
                        <CreateFolder />
                        <Condition>START_MENU_FOLDER=1</Condition>
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="ClassicShell" Level="1" Title="Classic Shell" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Absent="disallow" Display="expand">
            <ComponentRef Id="ClassicShell.chm" />
            <ComponentRef Id="ClassicShellReadme.rtf" />
            <ComponentRef Id="HISTORY.txt" />
            <ComponentRef Id="inichecksum.bin" />
            <ComponentRef Id="IvoSoft" />
            <ComponentRef Id="HelpLink" />
            <ComponentRef Id="ReadmeLink" />
            <ComponentRef Id="StartMenuDir" />
            <Feature Id="ClassicExplorer" Level="1" Title="!(loc.ExplorerTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.ExplorerDesc)">
                <ComponentRef Id="ClassicExplorer32.dll" />
                <?if $(var.x64)=1 ?>
                <ComponentRef Id="ClassicExplorer64.dll" />
                <?endif ?>
                <ComponentRef Id="ExplorerL10N.ini" />
                <ComponentRef Id="ClassicExplorerSettings.exe" />
                <ComponentRef Id="ExplorerSettingsLink" />
            </Feature>
            <Feature Id="ClassicStartMenu" Level="1" Title="!(loc.StartMenuTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.StartMenuDesc)">
                <ComponentRef Id="ClassicStartMenu.exe" />
                <ComponentRef Id="ClassicStartMenuDLL.dll" />
                <ComponentRef Id="ClassicShellService.exe" />
                <ComponentRef Id="StartMenuL10N.ini" />
                <ComponentRef Id="ClassicSkin.skin" />
                <ComponentRef Id="FullGlass.skin" />
                <ComponentRef Id="Metro.skin" />
                <ComponentRef Id="SmokedGlass.skin" />
                <ComponentRef Id="Windows7Aero.skin" />
                <ComponentRef Id="Windows7Basic.skin" />
                <ComponentRef Id="WindowsVistaAero.skin" />
                <ComponentRef Id="WindowsXPLuna.skin" />
                <ComponentRef Id="AutoRun" />
                <ComponentRef Id="MenuSettingsLink" />
            </Feature>
            <Feature Id="ClassicIE9" Level="2" Title="!(loc.IE9Title)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.IE9Desc)">
                <ComponentRef Id="ClassicIE9DLL_32.dll" />
                <ComponentRef Id="ClassicIE9_32.exe" />
                <?if $(var.x64)=1 ?>
                <ComponentRef Id="ClassicIE9DLL_64.dll" />
                <ComponentRef Id="ClassicIE9_64.exe" />
                <?endif ?>
                <ComponentRef Id="IE9SettingsLink" />
                <Condition Level="1">IE_BUILD&gt;=90000</Condition>
            </Feature>
            <Feature Id="ClassicShellUpdate" Level="1" Title="!(loc.UpdateTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.UpdateDesc)">
                <ComponentRef Id="ClassicShellUpdate.exe" />
                <ComponentRef Id="UpdateSettingsLink" />
            </Feature>
        </Feature>
        <UI>
            <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
            <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
            <TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />
            <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
            <Property Id="WixUI_Mode" Value="FeatureTree" />
            <DialogRef Id="ErrorDlg" />
            <DialogRef Id="FatalError" />
            <DialogRef Id="FilesInUse" />
            <DialogRef Id="MsiRMFilesInUse" />
            <DialogRef Id="PrepareDlg" />
            <DialogRef Id="ProgressDlg" />
            <DialogRef Id="ResumeDlg" />
            <DialogRef Id="UserExit" />
            <Publish Dialog="ExitDialog2" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
            <Publish Dialog="WelcomeDlg2" Control="Next" Event="NewDialog" Value="LicenseAgreementDlg2">1</Publish>
            <Publish Dialog="LicenseAgreementDlg2" Control="Back" Event="NewDialog" Value="WelcomeDlg2">1</Publish>
            <Publish Dialog="LicenseAgreementDlg2" Control="Next" Event="NewDialog" Value="CustomizeDlg2">LicenseAccepted = "1"</Publish>
            <Publish Dialog="CustomizeDlg2" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg2" Order="1">Installed</Publish>
            <Publish Dialog="CustomizeDlg2" Control="Back" Event="NewDialog" Value="LicenseAgreementDlg2" Order="2">NOT Installed</Publish>
            <Publish Dialog="CustomizeDlg2" Control="Next" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
            <Publish Dialog="VerifyReadyDlg2" Control="Back" Event="NewDialog" Value="CustomizeDlg2" Order="1">NOT Installed OR WixUI_InstallMode = "Change"</Publish>
            <Publish Dialog="VerifyReadyDlg2" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg2" Order="2">Installed</Publish>
            <Publish Dialog="MaintenanceWelcomeDlg2" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg2">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg2" Control="ChangeButton" Event="NewDialog" Value="CustomizeDlg2">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg2" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg2" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg2" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg2">1</Publish>
            <Dialog Id="WelcomeDlg2" Width="370" Height="270" Title="!(loc.WelcomeDlg_Title)">
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)" />
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="!(loc.WelcomeDlgBitmap)" />
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
                <Control Id="Description" Type="Text" X="135" Y="80" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.WelcomeDlgDescription)" />
                <Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.WelcomeDlgTitle)" />
            </Dialog>
            <InstallUISequence>
                <Show Dialog="WelcomeDlg2" Before="ProgressDlg">NOT Installed</Show>
            </InstallUISequence>
            <Dialog Id="LicenseAgreementDlg2" Width="370" Height="270" Title="!(loc.LicenseAgreementDlg_Title)">
                <Control Id="LicenseAcceptedCheckBox" Type="CheckBox" X="20" Y="207" Width="330" Height="18" CheckBoxValue="1" Property="LicenseAccepted" Text="!(loc.LicenseAgreementDlgLicenseAcceptedCheckBox)" />
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
                    <Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">CostingComplete = 1</Publish>
                    <Condition Action="disable"><![CDATA[LicenseAccepted <> "1"]]></Condition>
                    <Condition Action="enable">LicenseAccepted = "1"</Condition>
                </Control>
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.LicenseAgreementDlgBannerBitmap)" />
                <Control Id="LicenseText" Type="ScrollableText" X="20" Y="60" Width="330" Height="140" Sunken="yes" TabSkip="no">
                    <Text SourceFile="..\Docs\ClassicShellEULA.rtf" />
                </Control>
                <Control Id="Print" Type="PushButton" X="100" Y="243" Width="56" Height="17" Text="!(loc.WixUIPrint)">
                    <Publish Event="DoAction" Value="WixUIPrintEula">1</Publish>
                </Control>
                <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
                <Control Id="Description" Type="Text" X="25" Y="23" Width="340" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.LicenseAgreementDlgDescription)" />
                <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.LicenseAgreementDlgTitle)" />
            </Dialog>
            <Dialog Id="CustomizeDlg2" Width="370" Height="270" Title="!(loc.CustomizeDlg_Title)" TrackDiskSpace="yes">
                <Control Id="Tree" Type="SelectionTree" X="25" Y="85" Width="175" Height="92" Property="_BrowseProperty" Sunken="yes" TabSkip="no" Text="!(loc.CustomizeDlgTree)" />
                <Control Id="Browse" Type="PushButton" X="294" Y="212" Width="66" Height="17" Text="!(loc.CustomizeDlgBrowse)">
                    <Publish Event="SelectionBrowse" Value="BrowseDlg">1</Publish>
                    <Condition Action="hide">Installed</Condition>
                    <Condition Action="disable">Installed</Condition>
                </Control>
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
                    <Subscribe Event="SelectionNoItems" Attribute="Enabled" />
                </Control>
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.CustomizeDlgBannerBitmap)" />
                <Control Id="Text" Type="Text" X="25" Y="55" Width="320" Height="20" Text="!(loc.CustomizeDlgText)" />
                <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="2" />
                <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.CustomizeDlgDescription)" />
                <Control Id="Title" Type="Text" X="15" Y="6" Width="210" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.CustomizeDlgTitle)" />
                <Control Id="Box" Type="GroupBox" X="210" Y="81" Width="150" Height="118" />
                <Control Id="ItemDescription" Type="Text" X="215" Y="90" Width="131" Height="50" Text="!(loc.CustomizeDlgItemDescription)">
                    <Subscribe Event="SelectionDescription" Attribute="Text" />
                </Control>
                <Control Id="ItemSize" Type="Text" X="215" Y="140" Width="131" Height="50" Text="!(loc.CustomizeDlgItemSize)">
                    <Subscribe Event="SelectionSize" Attribute="Text" />
                </Control>
                <Control Id="Location" Type="Text" X="90" Y="214" Width="200" Height="20" Text="!(loc.CustomizeDlgLocation)">
                    <Subscribe Event="SelectionPath" Attribute="Text" />
                    <Subscribe Event="SelectionPathOn" Attribute="Visible" />
                    <Condition Action="hide">Installed</Condition>
                </Control>
                <Control Id="LocationLabel" Type="Text" X="25" Y="214" Width="65" Height="10" Text="!(loc.CustomizeDlgLocationLabel)">
                    <Subscribe Event="SelectionPathOn" Attribute="Visible" />
                    <Condition Action="hide">Installed</Condition>
                </Control>
                <Control Type="CheckBox" Id="StartMenu" Width="172" Height="17" X="25" Y="181" Text="!(loc.StartMenuFolder)" Property="START_MENU_FOLDER" CheckBoxValue="1">
                    <Condition Action="hide">Installed</Condition>
                </Control>
                <Control Type="Line" Id="MiddleLine" Width="370" Height="17" X="0" Y="205">
                    <Condition Action="hide">Installed</Condition>
                </Control>
            </Dialog>
            <Dialog Id="VerifyReadyDlg2" Width="370" Height="270" Title="!(loc.VerifyReadyDlg_Title)" TrackDiskSpace="yes">
                <Control Id="Install" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgInstall)">
                    <Condition Action="show">NOT Installed AND ALLUSERS</Condition>
                    <Condition Action="enable">NOT Installed</Condition>
                    <Condition Action="default">NOT Installed</Condition>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="InstallNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgInstall)">
                    <Condition Action="show">NOT Installed AND NOT ALLUSERS</Condition>
                    <Condition Action="enable">NOT Installed</Condition>
                    <Condition Action="default">NOT Installed</Condition>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="Change" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgChange)">
                    <Condition Action="show">WixUI_InstallMode = "Change" AND ALLUSERS AND (ADDLOCAL OR REMOVE)</Condition>
                    <Condition Action="enable">WixUI_InstallMode = "Change"</Condition>
                    <Condition Action="default">WixUI_InstallMode = "Change"</Condition>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="ChangeNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgChange)">
                    <Condition Action="show">WixUI_InstallMode = "Change" AND (NOT ALLUSERS OR (NOT ADDLOCAL AND NOT REMOVE))</Condition>
                    <Condition Action="enable">WixUI_InstallMode = "Change"</Condition>
                    <Condition Action="default">WixUI_InstallMode = "Change"</Condition>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="Repair" Type="PushButton" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRepair)">
                    <Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
                    <Condition Action="enable">WixUI_InstallMode = "Repair"</Condition>
                    <Condition Action="default">WixUI_InstallMode = "Repair"</Condition>
                    <Publish Event="ReinstallMode" Value="ecmus"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="Reinstall" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="Remove" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRemove)">
                    <Condition Action="show">WixUI_InstallMode = "Remove" AND ALLUSERS</Condition>
                    <Condition Action="enable">WixUI_InstallMode = "Remove"</Condition>
                    <Publish Event="Remove" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="RemoveNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRemove)">
                    <Condition Action="show">WixUI_InstallMode = "Remove" AND NOT ALLUSERS</Condition>
                    <Condition Action="enable">WixUI_InstallMode = "Remove"</Condition>
                    <Publish Event="Remove" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
                    <Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
                    <Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
                    <Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
                </Control>
                <Control Id="InstallTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgInstallTitle)">
                    <Condition Action="show">NOT Installed</Condition>
                </Control>
                <Control Id="InstallText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" Text="!(loc.VerifyReadyDlgInstallText)">
                    <Condition Action="show">NOT Installed</Condition>
                </Control>
                <Control Id="ChangeTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgChangeTitle)">
                    <Condition Action="show">WixUI_InstallMode = "Change"</Condition>
                </Control>
                <Control Id="ChangeText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" Text="!(loc.VerifyReadyDlgChangeText)">
                    <Condition Action="show">WixUI_InstallMode = "Change"</Condition>
                </Control>
                <Control Id="RepairTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgRepairTitle)">
                    <Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
                </Control>
                <Control Id="RepairText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" NoPrefix="yes" Text="!(loc.VerifyReadyDlgRepairText)">
                    <Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
                </Control>
                <Control Id="RemoveTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgRemoveTitle)">
                    <Condition Action="show">WixUI_InstallMode = "Remove"</Condition>
                </Control>
                <Control Id="RemoveText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" NoPrefix="yes" Text="!(loc.VerifyReadyDlgRemoveText)">
                    <Condition Action="show">WixUI_InstallMode = "Remove"</Condition>
                </Control>
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)">
                    <Condition Action="default">WixUI_InstallMode = "Remove"</Condition>
                </Control>
                <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.VerifyReadyDlgBannerBitmap)" />
                <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
            </Dialog>
            <Dialog Id="MaintenanceWelcomeDlg2" Width="370" Height="270" Title="!(loc.MaintenanceWelcomeDlg_Title)">
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
                    <Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">CostingComplete = 1</Publish>
                </Control>
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="!(loc.MaintenanceWelcomeDlgBitmap)" />
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
                <Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceWelcomeDlgTitle)" />
                <Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceWelcomeDlgDescription)" />
            </Dialog>
            <InstallUISequence>
                <Show Dialog="MaintenanceWelcomeDlg2" Before="ProgressDlg">Installed AND NOT RESUME AND NOT Preselected</Show>
            </InstallUISequence>
            <Dialog Id="MaintenanceTypeDlg2" Width="370" Height="270" Title="!(loc.MaintenanceTypeDlg_Title)">
                <Control Id="ChangeButton" Type="PushButton" X="40" Y="65" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgChangeButtonTooltip)" Default="yes" Text="!(loc.MaintenanceTypeDlgChangeButton)">
                    <Publish Property="WixUI_InstallMode" Value="Change">1</Publish>
                </Control>
                <Control Id="ChangeText" Type="Text" X="60" Y="85" Width="280" Height="20" Text="!(loc.MaintenanceTypeDlgChangeText)" />
                <Control Id="RepairButton" Type="PushButton" X="40" Y="118" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgRepairButtonTooltip)" Text="!(loc.MaintenanceTypeDlgRepairButton)">
                    <Publish Property="WixUI_InstallMode" Value="Repair">1</Publish>
                </Control>
                <Control Id="RepairText" Type="Text" X="60" Y="138" Width="280" Height="30" Text="!(loc.MaintenanceTypeDlgRepairText)" />
                <Control Id="RemoveButton" Type="PushButton" X="40" Y="171" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgRemoveButtonTooltip)" Text="!(loc.MaintenanceTypeDlgRemoveButton)">
                    <Publish Property="WixUI_InstallMode" Value="Remove">1</Publish>
                    <Condition Action="disable">ARPNOREMOVE</Condition>
                </Control>
                <Control Id="RemoveText" Type="Text" X="60" Y="191" Width="280" Height="20" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgRemoveText)">
                    <Condition Action="hide">ARPNOREMOVE</Condition>
                </Control>
                <Control Id="RemoveDisabledText" Type="Text" X="60" Y="191" Width="280" Height="20" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgRemoveDisabledText)" Hidden="yes">
                    <Condition Action="show">ARPNOREMOVE</Condition>
                </Control>
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUINext)" />
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.MaintenanceTypeDlgBannerBitmap)" />
                <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
                <Control Id="Title" Type="Text" X="15" Y="6" Width="340" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgTitle)" />
                <Control Id="Description" Type="Text" X="25" Y="23" Width="340" Height="20" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgDescription)" />
            </Dialog>
            <Dialog Id="ExitDialog2" Width="370" Height="270" Title="!(loc.ExitDialog_Title)">
                <Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="!(loc.WixUIFinish)" />
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUICancel)" />
                <Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="!(loc.ExitDialogBitmap)" />
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
                <Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="40" Transparent="yes" NoPrefix="yes" Text="!(loc.ExitDialogDescription)" />
                <Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.ExitDialogTitle)" />
                <Control Id="OptionalText" Type="Text" X="135" Y="110" Width="220" Height="80" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="[WIXUI_EXITDIALOGOPTIONALTEXT]">
                    <Condition Action="show">WIXUI_EXITDIALOGOPTIONALTEXT AND NOT Installed</Condition>
                </Control>
                <Control Id="OptionalCheckBox" Type="CheckBox" X="11" Y="243" Width="130" Height="17" Hidden="yes" Property="WIXUI_EXITDIALOGOPTIONALCHECKBOX" CheckBoxValue="1" Text="!(loc.ViewReadme)">
                    <Condition Action="show">NOT Installed</Condition>
                </Control>
            </Dialog>
            <Publish Dialog="ExitDialog2" Control="Finish" Event="DoAction" Value="ViewReadme">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
            <Publish Dialog="ExitDialog2" Control="Finish" Event="DoAction" Value="LaunchStartMenu"><![CDATA[!ClassicStartMenu<>3 AND &ClassicStartMenu=3]]></Publish>
            <InstallUISequence>
                <Show Dialog="ExitDialog2" OnExit="success" />
            </InstallUISequence>
            <AdminUISequence>
                <Show Dialog="ExitDialog2" OnExit="success" />
            </AdminUISequence>
        </UI>
        <UIRef Id="WixUI_Common" />
        <DirectoryRef Id="APPLICATIONFOLDER">
            <Component Id="ClassicShell.chm" Guid="29AB35F9-D611-4B34-BCE3-517C10C839AF" Win64="$(var.CS_WIN64)">
                <File Id="ClassicShell.chm" KeyPath="yes" Source="..\Docs\Help\ClassicShell.chm" Vital="yes" />
            </Component>
            <Component Id="ClassicExplorer32.dll" Guid="21833BA5-3F17-4237-BA0C-2D01D273A27F" Win64="$(var.CS_WIN64)">
                <File Id="ClassicExplorer32.dll" KeyPath="yes" Source="..\ClassicExplorer\Setup\ClassicExplorer32.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
            </Component>
            <Component Id="ClassicExplorerSettings.exe" Guid="CBD00200-FAED-48F6-B8C1-F033BDB00A28" Win64="$(var.CS_WIN64)">
                <File Id="ClassicExplorerSettings.exe" KeyPath="yes" Source="..\ClassicExplorer\Release\ClassicExplorerSettings.exe" Checksum="yes" Vital="yes" />
            </Component>
            <Component Id="ClassicIE9DLL_32.dll" Guid="C85DEB7F-FB76-42E9-B1F4-7A7C7DCBD482" Win64="$(var.CS_WIN64)">
                <File Id="ClassicIE9DLL_32.dll" KeyPath="yes" Source="..\ClassicIE9\Setup\ClassicIE9DLL_32.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
            </Component>
            <Component Id="ClassicIE9_32.exe" Guid="0D0BF4CF-9753-4867-9DE5-69D3DA19DC41" Win64="$(var.CS_WIN64)">
                <File Id="ClassicIE9_32.exe" KeyPath="yes" Source="..\ClassicIE9\Release\ClassicIE9_32.exe" Checksum="yes" Vital="yes" />
                <Shortcut Id="IE9Settings" Name="IE9 Settings" Advertise="no" Description="!(loc.IE9SettingsDesc)" Target="[APPLICATIONFOLDER]ClassicIE9_32.exe" WorkingDirectory="APPLICATIONFOLDER" />
            </Component>
            <?if $(var.x64)=1 ?>
            <Component Id="ClassicExplorer64.dll" Guid="A82DBFC3-E19B-4E02-AF50-50363C2B0714" Win64="yes">
                <File Id="ClassicExplorer64.dll" KeyPath="yes" Source="..\ClassicExplorer\Setup64\ClassicExplorer64.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
            </Component>
            <Component Id="ClassicIE9DLL_64.dll" Guid="6EC7C9A0-BB8E-4B4F-9F63-D03EFEB65B41" Win64="yes">
                <File Id="ClassicIE9DLL_64.dll" KeyPath="yes" Source="..\ClassicIE9\Setup64\ClassicIE9DLL_64.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
            </Component>
            <Component Id="ClassicIE9_64.exe" Guid="89BDF7B9-D8F4-46BE-9F29-344B384D753C" Win64="yes">
                <File Id="ClassicIE9_64.exe" KeyPath="yes" Source="..\ClassicIE9\Release64\ClassicIE9_64.exe" Checksum="yes" Vital="yes" />
            </Component>
            <Component Id="ClassicStartMenu.exe" Guid="F74C0FF3-A8C0-4B6E-AFD2-F9467DE4D90B" Win64="yes">
                <File Id="ClassicStartMenu.exe" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Setup64\ClassicStartMenu.exe" Vital="yes" />
                <Shortcut Id="StartMenuSettings" Name="Start Menu Settings" Advertise="no" Arguments="-settings" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicStartMenu.exe" WorkingDirectory="APPLICATIONFOLDER" />
            </Component>
            <Component Id="ClassicStartMenuDLL.dll" Guid="C5226061-17DE-4DF6-A088-CC84F6A7BE84" Win64="yes">
                <File Id="ClassicStartMenuDLL.dll" Checksum="yes" KeyPath="yes" Source="..\ClassicStartMenu\Setup64\ClassicStartMenuDLL.dll" Vital="yes" />
            </Component>
            <?else ?>
            <Component Id="ClassicStartMenu.exe" Guid="F74C0FF3-A8C0-4B6E-AFD2-F9467DE4D90B" Win64="no">
                <File Id="ClassicStartMenu.exe" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Setup\ClassicStartMenu.exe" Vital="yes" />
                <Shortcut Id="StartMenuSettings" Name="Start Menu Settings" Advertise="no" Arguments="-settings" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicStartMenu.exe" WorkingDirectory="APPLICATIONFOLDER" />
            </Component>
            <Component Id="ClassicStartMenuDLL.dll" Guid="C5226061-17DE-4DF6-A088-CC84F6A7BE84" Win64="no">
                <File Id="ClassicStartMenuDLL.dll" Checksum="yes" KeyPath="yes" Source="..\ClassicStartMenu\Setup\ClassicStartMenuDLL.dll" Vital="yes" />
            </Component>
            <?endif ?>
            <Component Id="ClassicShellReadme.rtf" Guid="A6B815ED-91BD-4F61-83B3-F98041026BB9" Win64="$(var.CS_WIN64)">
                <File Id="ClassicShellReadme.rtf" KeyPath="yes" Source="..\Docs\ClassicShellReadme.rtf" Vital="yes" />
            </Component>
            <Component Id="ExplorerL10N.ini" Guid="" Win64="$(var.CS_WIN64)">
                <File Id="ExplorerL10N.ini" KeyPath="yes" Source="..\ClassicExplorer\ExplorerL10N.ini" Vital="yes" />
            </Component>
            <Component Id="StartMenuL10N.ini" Guid="" Win64="$(var.CS_WIN64)">
                <File Id="StartMenuL10N.ini" KeyPath="yes" Source="..\ClassicStartMenu\StartMenuL10N.ini" Vital="yes" />
            </Component>
            <Component Id="HISTORY.txt" Guid="5264FC00-E363-45EE-B185-84AA048CD559" Win64="$(var.CS_WIN64)">
                <File Id="HISTORY.txt" KeyPath="yes" Source="..\HISTORY.txt" Vital="yes" />
            </Component>
            <Component Id="inichecksum.bin" Guid="A13EA462-14B3-4f2c-8C48-A3F14B057709" Win64="$(var.CS_WIN64)">
                <File Id="inichecksum.bin" KeyPath="yes" Source="inichecksum.bin" Vital="yes" />
            </Component>
            <Component Id="ClassicShellUpdate.exe" Guid="FB6C213F-B670-4888-8B2C-12E807E335A7" Win64="$(var.CS_WIN64)">
                <File Id="ClassicShellUpdate" KeyPath="yes" Source="..\ClassicShellUpdate\Release\ClassicShellUpdate.exe" Checksum="yes" Vital="yes" />
            </Component>
            <Component Id="ClassicShellService.exe" Guid="F948205B-B3CE-4AF3-9BBE-4C6382363596" Win64="$(var.CS_WIN64)">
                <File Id="ClassicShellService.exe" KeyPath="yes" Source="..\ClassicShellService\Setup\ClassicShellService.exe" Checksum="yes" Vital="yes" />
                <ServiceInstall Name="ClassicShellService" Type="ownProcess" Start="auto" ErrorControl="normal" DisplayName="Classic Shell Service" Description="Launches the start button after logon" Account="LocalSystem" Interactive="no" Vital="yes" Id="ServiceInstaller" LoadOrderGroup="UIGroup" />
                <ServiceControl Id="StartService" Name="ClassicShellService" Start="install" Stop="both" Remove="uninstall" Wait="yes" />
                <Condition>VersionNT&gt;=602</Condition>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="Skins">
            <Component Id="ClassicSkin.skin" Guid="301CA0BC-1DD4-4A25-8E1E-FA1A0134A814" Win64="$(var.CS_WIN64)">
                <File Id="ClassicSkin.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Classic Skin.skin" Vital="yes" />
            </Component>
            <Component Id="FullGlass.skin" Guid="B71131E1-ED7C-4EED-9289-528B50E2C8EE" Win64="$(var.CS_WIN64)">
                <File Id="FullGlass.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Full Glass.skin" Vital="yes" />
            </Component>
            <Component Id="Metro.skin" Guid="6952D8AF-32F7-43EA-8AC3-51D6A7274EB6" Win64="$(var.CS_WIN64)">
                <File Id="Metro.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Metro.skin" Vital="yes" />
            </Component>
            <Component Id="SmokedGlass.skin" Guid="19BF925A-85C0-4EFC-8F0C-091BFE5355FA" Win64="$(var.CS_WIN64)">
                <File Id="SmokedGlass.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Smoked Glass.skin" Vital="yes" />
            </Component>
            <Component Id="Windows7Aero.skin" Guid="3D01005D-B188-4DB7-8EB3-9955D305C877" Win64="$(var.CS_WIN64)">
                <File Id="Windows7Aero.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Windows 7 Aero.skin" Vital="yes" />
            </Component>
            <Component Id="Windows7Basic.skin" Guid="D5E45F0C-55AC-4349-8B1F-64417C23F33F" Win64="$(var.CS_WIN64)">
                <File Id="Windows7Basic.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Windows 7 Basic.skin" Vital="yes" />
            </Component>
            <Component Id="WindowsVistaAero.skin" Guid="8619F242-0D39-48A5-820B-4FD2CEEF433A" Win64="$(var.CS_WIN64)">
                <File Id="WindowsVistaAero.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Windows Vista Aero.skin" Vital="yes" />
            </Component>
            <Component Id="WindowsXPLuna.skin" Guid="FBC71683-D1B5-4F6C-A14C-AD9B555D10BB" Win64="$(var.CS_WIN64)">
                <File Id="WindowsXPLuna.skin" KeyPath="yes" Checksum="yes" Source="..\ClassicStartMenu\Skins\Windows XP Luna.skin" Vital="yes" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="TARGETDIR">
            <Component Id="IvoSoft" Guid="19EC9EFC-B901-4EAB-B800-6E98D2261077" Win64="$(var.CS_WIN64)">
                <RegistryKey Root="HKLM" Key="Software\IvoSoft\ClassicShell" Action="createAndRemoveOnUninstall">
                    <RegistryValue Type="integer" Name="Version" KeyPath="yes" Value="$(env.CS_VERSION_NUM)" />
                    <RegistryValue Type="string" Name="Path" Value="[APPLICATIONFOLDER]" />
                </RegistryKey>
            </Component>
            <Component Id="AutoRun" Guid="64987C22-72C7-419D-B5A5-D2E6CB4865B6" Win64="$(var.CS_WIN64)">
                <RegistryKey Action="create" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Run">
                    <RegistryValue Value="[APPLICATIONFOLDER]ClassicStartMenu.exe" Type="string" Name="Classic Start Menu" />
                </RegistryKey>
                <Condition>VersionNT&lt;602</Condition>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="StartMenuDir">
            <Component Id="HelpLink" Guid="D631C351-7BD4-42CE-813C-5D46347068AF">
                <Shortcut Id="HelpLink" Name="Classic Shell Help" Advertise="no" Description="!(loc.HelpDesc)" Target="[APPLICATIONFOLDER]ClassicShell.chm" WorkingDirectory="APPLICATIONFOLDER" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
            <Component Id="ReadmeLink" Guid="A54415C8-412E-4768-8829-8898122E4AED">
                <Shortcut Id="ReadmeLink" Name="Classic Shell Readme" Advertise="no" Description="!(loc.ReadmeDesc)" Target="[APPLICATIONFOLDER]ClassicShellReadme.rtf" WorkingDirectory="APPLICATIONFOLDER" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
            <Component Id="UpdateSettingsLink" Guid="10B5A082-6C92-4EA7-AFF8-21AE3D2D7FE0">
                <Shortcut Id="UpdateSettingsLink" Name="Classic Shell Update Settings" Advertise="no" Description="!(loc.UpdateSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicShellUpdate.exe" WorkingDirectory="APPLICATIONFOLDER" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
            <Component Id="ExplorerSettingsLink" Guid="6EC027F2-115D-4110-8189-DDAFC78169EC">
                <Shortcut Id="ExplorerSettingsLink" Name="Classic Explorer Settings" Advertise="no" Description="!(loc.ExplorerSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicExplorerSettings.exe" WorkingDirectory="APPLICATIONFOLDER" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
            <Component Id="MenuSettingsLink" Guid="F2B638D3-EBE1-4C8F-9C53-08A4F21ACFA3">
                <Shortcut Id="MenuSettingsLink" Name="Classic Start Menu Settings" Advertise="no" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicStartMenu.exe" WorkingDirectory="APPLICATIONFOLDER" Arguments="-settings" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
            <Component Id="IE9SettingsLink" Guid="10C0226C-22A9-49E4-AA65-C96AD7A504CC">
                <Shortcut Id="IE9SettingsLink" Name="Classic IE9 Settings" Advertise="no" Description="!(loc.IE9SettingsDesc)" Target="[APPLICATIONFOLDER]ClassicIE9_32.exe" WorkingDirectory="APPLICATIONFOLDER" />
                <CreateFolder />
                <Condition>START_MENU_FOLDER=1</Condition>
            </Component>
        </DirectoryRef>
        <Icon Id="icon.ico" SourceFile="..\ClassicShellSetup\ClassicShell.ico" />
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />
        <Property Id="ApplicationFolderName" Value="Classic Shell" />
        <Property Id="WixAppFolder" Value="WixPerMachineFolder" />
        <Property Id="ALLUSERS" Value="1" />
        <Property Id="WixShellExecTarget" Value="[#ClassicShellReadme.rtf]" />
        <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1" />
        <Property Id="ARPHELPLINK" Value="http://sourceforge.net/projects/classicshell/forums/forum/1049756" />
        <Property Id="ARPSIZE" Value="9000" />
        <Property Id="ARPURLINFOABOUT" Value="http://classicshell.sourceforge.net/" />
        <Property Id="ARPNOMODIFY" Value="1" />
        <Property Id="ARPNOREPAIR" Value="1" />
        <Property Id="START_MENU_FOLDER" Value="1" />
        <Property Id="IE_BUILD" Value="0">
            <RegistrySearch Id="IEBuild" Root="HKLM" Key="Software\Microsoft\Internet Explorer" Name="Build" Type="raw" />
        </Property>
        <CustomAction Id="ViewReadme" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />
        <CustomAction Id="LaunchStartMenu" Impersonate="yes" ExeCommand="" FileKey="ClassicStartMenu.exe" Return="asyncNoWait" />
        <CustomAction Id="CloseStartMenu" Impersonate="yes" BinaryKey="SetupHelper.exe" Return="ignore" ExeCommand="exitSM" />
        <CustomAction Id="DeleteInis" Impersonate="no" BinaryKey="SetupHelper.exe" Return="ignore" ExeCommand="ini [UILevel] &quot;[APPLICATIONFOLDER]" Execute="deferred" />
        <CustomAction Id="StoreRun" Impersonate="yes" BinaryKey="SetupHelper.exe" Return="ignore" ExeCommand="run store" Execute="immediate" />
        <CustomAction Id="RestoreRun" Impersonate="no" BinaryKey="SetupHelper.exe" Return="ignore" ExeCommand="run restore" Execute="deferred" />
        <WixVariable Id="WixUIBannerBmp" Value="..\ClassicShellSetup\banner.jpg" />
        <WixVariable Id="WixUIDialogBmp" Value="..\ClassicShellSetup\dialog.jpg" />
        <Upgrade Id="$(var.CS_UPGRADE)">
            <UpgradeVersion Property="PREVIOUSVERSIONSINSTALLED" Maximum="$(env.CS_VERSION)" />
            <UpgradeVersion Property="NEWERPRODUCTFOUND" Minimum="$(env.CS_VERSION)" IncludeMinimum="yes" OnlyDetect="yes" />
        </Upgrade>
        <InstallExecuteSequence>
            <RemoveExistingProducts After="InstallInitialize" />
            <Custom Action="CloseStartMenu" Before="InstallValidate"><![CDATA[((!ClassicStartMenu=3) AND (&ClassicStartMenu=2)) OR PREVIOUSVERSIONSINSTALLED]]></Custom>
            <Custom Action="DeleteInis" After="RemoveExistingProducts"><![CDATA[(REMOVE~="ALL") AND (ProductState<>1)]]></Custom>
            <Custom Action="StoreRun" Before="InstallInitialize">BACKUP_RUN=1</Custom>
            <Custom Action="RestoreRun" After="RemoveExistingProducts">BACKUP_RUN=1</Custom>
        </InstallExecuteSequence>
        <Binary Id="SetupHelper.exe" SourceFile="..\ClassicShellSetup\SetupHelper\Release\SetupHelper.exe" />
    </Product>
</Wix>